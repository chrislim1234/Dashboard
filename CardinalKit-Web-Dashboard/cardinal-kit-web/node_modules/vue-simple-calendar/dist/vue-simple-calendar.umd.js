(function(h,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(h=typeof globalThis<"u"?globalThis:h||self,t(h.CalendarView={},h.Vue))})(this,function(h,t){"use strict";const S=()=>L(new Date),Q=(e,o,n)=>{switch(o){case"year":return new Date(e.getFullYear(),0);case"month":return new Date(e.getFullYear(),e.getMonth());case"week":return E(e,n);default:return e}},J=e=>[...Array(7)].map((o,n)=>P(e,n)),P=(e,o)=>new Date(e.getFullYear(),e.getMonth(),e.getDate()+o,e.getHours(),e.getMinutes(),e.getSeconds()),E=(e,o)=>P(e,(o-e.getDay()-7)%-7),K=(e,o)=>P(E(e,o),7),M=e=>new Date(e.getFullYear(),e.getMonth()),X=e=>Math.ceil(e.getDate()/7),Z=(e,o,n)=>new Date(e.getFullYear()+(o=="year"?n:0),e.getMonth()+(o=="month"?n:0),e.getDate()+(o=="week"?n*7:0)),T=e=>("0"+String(e.getMonth()+1)).slice(-2),A=e=>("0"+String(e.getDate())).slice(-2),x=e=>e.getFullYear()+"-"+T(e),_=e=>x(e)+"-"+A(e),ee=e=>T(e)+"-"+A(e),te=(e,o,n)=>{if(e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0)return"";if(!F()){var d=new Date().getTimezoneOffset()*6e4;return new Date(e.getTime()-d).toISOString().slice(11,16)}return e.toLocaleTimeString(o,n)},ae=(e,o,n,d)=>{const u=e.getFullYear()===o.getFullYear(),D=z(e,o),y=!(n==="year")&&!(n==="month");let f=[];return f.push(d[e.getMonth()]),y&&(f.push(" "),f.push(e.getDate())),u||(f.push(y?", ":" "),f.push(e.getFullYear())),!D||!u?(f.push(" \u2013 "),D||f.push(d[o.getMonth()]),y&&f.push(" ")):y&&f.push(" \u2013 "),y?(f.push(o.getDate()),f.push(", ")):f.push(" "),f.push(o.getFullYear()),f.join("")},U=(e,o)=>{const n=Date.UTC(o.getFullYear(),o.getMonth(),o.getDate()),d=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return(n-d)/864e5},ne=(e,o)=>e&&o&&U(e,o)===0,re=(e,o)=>e&&o&&e.getTime()===o.getTime(),z=(e,o)=>e&&o&&e.getFullYear()===o.getFullYear()&&e.getMonth()===o.getMonth(),oe=e=>M(e)<M(S()),se=e=>M(e)>M(S()),ie=e=>L(e)>S(),le=e=>L(e)<S(),de=e=>e.getMonth()!==P(e,7).getMonth(),ce=e=>e.getMonth()!==P(e,1).getMonth(),R=e=>{let o=[...Array(7)].map(n=>0);return e.split(/\D/,7).forEach((n,d)=>o[d]=Number(n)),o[1]--,new Date(o[0],o[1],o[2],o[3],o[4],o[5],o[6])},Y=e=>typeof e=="string"?R(e):new Date(e),L=e=>{const o=new Date(e);return o.setHours(0,0,0,0),o},ue=e=>e.substring(0,2),F=()=>typeof Intl<"u",r={addDays:P,beginningOfMonth:M,beginningOfPeriod:Q,beginningOfWeek:E,dateOnly:L,dayDiff:U,daysOfWeek:J,endOfWeek:K,formattedPeriod:ae,formattedTime:te,fromIsoStringToLocalDate:R,getDefaultBrowserLocale:()=>typeof navigator>"u"?"unk":(navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language).toLowerCase(),getFormattedMonthNames:(e,o)=>{if(!F())return[...Array(12)].map(d=>"");const n=new Intl.DateTimeFormat(e,{month:o});return[...Array(12)].map((d,u)=>n.format(new Date(2017,u,1)))},getFormattedWeekdayNames:(e,o,n)=>{if(!F())return[...Array(7)].map(u=>"");const d=new Intl.DateTimeFormat(e,{weekday:o});return[...Array(7)].map((u,D)=>d.format(new Date(2017,0,(D+1+n)%7)))},incrementPeriod:Z,instanceOfMonth:X,isFutureMonth:se,isInFuture:ie,isInPast:le,isLastDayOfMonth:ce,isLastInstanceOfMonth:de,isoMonthDay:ee,isoYearMonth:x,isoYearMonthDay:_,isPastMonth:oe,isSameDate:ne,isSameDateTime:re,isSameMonth:z,languageCode:ue,normalizeItem:(e,o)=>{const n=e.classes?[...e.classes]:[];return o&&n.push("isHovered"),{originalItem:e,startDate:Y(e.startDate),endDate:Y(e.endDate||e.startDate),classes:n,title:e.title||"Untitled",id:e.id,url:e.url}},paddedDay:A,paddedMonth:T,supportsIntl:F,today:S,toLocalDate:Y};class fe{constructor(){this.currentDragItem=null,this.dateSelectionOrigin=null,this.currentHoveredItemId="",this.CalendarMath=r}}const ge={class:"cv-header-days"},me={key:0,class:"cv-weeknumber"},pe=["aria-multiselectable"],De={key:0,class:"cv-weeknumber"},he={class:"cv-weekdays"},ye=["draggable","aria-grabbed","aria-label","aria-selected","aria-dropeffect","onClick","onDragstart","onDrop","onDragover","onDragenter","onDragleave"],be={class:"cv-day-number"},Pe=["draggable","aria-grabbed","title","onDragstart","onMouseenter","onMouseleave","onClick","innerHTML"],ke=t.defineComponent({__name:"CalendarView",props:{showDate:{type:Date,default:void 0},displayPeriodUom:{type:String,default:"month"},displayPeriodCount:{type:Number,default:1},displayWeekNumbers:{type:Boolean,default:!1},locale:{type:String,default:void 0},monthNameFormat:{type:String,default:"long"},weekdayNameFormat:{type:String,default:"short"},showTimes:{type:Boolean,default:!1},timeFormatOptions:{type:Object,default:()=>{}},disablePast:{type:Boolean,default:!1},disableFuture:{type:Boolean,default:!1},enableDateSelection:{type:Boolean,default:!1},selectionStart:{type:Date,default:null},selectionEnd:{type:Date,default:null},enableDragDrop:{type:Boolean,default:!1},startingDayOfWeek:{type:Number,default:0},items:{type:Array,default:()=>[]},dateClasses:{type:Object,default:()=>{}},itemTop:{type:String,default:"1.4em"},itemContentHeight:{type:String,default:"1.4em"},itemBorderHeight:{type:String,default:"2px"},periodChangedCallback:{type:Function,default:void 0},currentPeriodLabel:{type:String,default:""},currentPeriodLabelIcons:{type:String,default:"\u21E4-\u21E5"},doEmitItemMouseEvents:{type:Boolean,default:!1}},emits:["input","period-changed","click-date","click-item","item-mouseenter","item-mouseleave","drag-start","drag-over-date","drag-enter-date","drag-leave-date","drop-on-date","date-selection","date-selection-start","date-selection-finish"],setup(e,{emit:o}){const n=e,d=t.reactive(new fe),u=t.computed(()=>n.locale||r.getDefaultBrowserLocale()),D=t.computed(()=>n.showDate?r.dateOnly(n.showDate):r.today()),m=t.computed(()=>r.beginningOfPeriod(D.value,n.displayPeriodUom,n.startingDayOfWeek)),C=t.computed(()=>r.addDays(r.incrementPeriod(m.value,n.displayPeriodUom,n.displayPeriodCount),-1)),y=t.computed(()=>{const a=r.beginningOfWeek(r.beginningOfPeriod(m.value,"year",0),n.startingDayOfWeek),s=r.beginningOfWeek(m.value,n.startingDayOfWeek);return 1+Math.floor(r.dayDiff(a,s)/7)}),f=t.computed(()=>r.beginningOfWeek(m.value,n.startingDayOfWeek)),N=t.computed(()=>r.endOfWeek(C.value,n.startingDayOfWeek)),Be=t.computed(()=>{const a=Math.floor((r.dayDiff(f.value,N.value)+1)/7);return[...Array(a)].map((s,l)=>r.addDays(f.value,l*7))}),W=t.computed(()=>r.getFormattedMonthNames(u.value,n.monthNameFormat)),Ee=t.computed(()=>r.getFormattedWeekdayNames(u.value,n.weekdayNameFormat,n.startingDayOfWeek)),$=t.computed(()=>n.items?n.items.map(a=>r.normalizeItem(a,a.id===d.currentHoveredItemId)):[]),V=t.computed(()=>r.beginningOfPeriod(r.today(),n.displayPeriodUom,n.startingDayOfWeek)),Te=t.computed(()=>r.addDays(r.incrementPeriod(V.value,n.displayPeriodUom,n.displayPeriodCount),-1)),Ae=t.computed(()=>r.formattedPeriod(m.value,C.value,n.displayPeriodUom,W.value)),Ye=t.computed(()=>{const a=V.value,s=m.value;return n.currentPeriodLabel?n.currentPeriodLabel==="icons"?n.currentPeriodLabelIcons[Math.sign(a.getTime()-s.getTime())+1]:n.currentPeriodLabel:r.formattedPeriod(a,Te.value,n.displayPeriodUom,W.value)}),Ne=t.computed(()=>({previousYear:k(-12),previousPeriod:k(-1),nextPeriod:k(1),previousFullPeriod:k(-n.displayPeriodCount),nextFullPeriod:k(n.displayPeriodCount),nextYear:k(12),currentPeriod:V.value,currentPeriodLabel:Ye.value,periodStart:m.value,periodEnd:C.value,displayLocale:u.value,displayFirstDate:f.value,displayLastDate:N.value,monthNames:W.value,fixedItems:$.value,periodLabel:Ae.value})),We=t.computed(()=>({periodStart:m,periodEnd:C,displayFirstDate:f,displayLastDate:N}));t.watch(()=>We,a=>{n.periodChangedCallback&&(o("period-changed"),n.periodChangedCallback(a,"watch"))},{immediate:!0,deep:!0});const $e=(a,s)=>{n.disablePast&&r.isInPast(a)||n.disableFuture&&r.isInFuture(a)||o("click-date",a,j(a,a),s)},Ve=(a,s)=>o("click-item",a,s),O=a=>"dow"+(a+n.startingDayOfWeek)%7,k=a=>{const s=r.incrementPeriod(m.value,n.displayPeriodUom,a),l=r.incrementPeriod(s,n.displayPeriodUom,n.displayPeriodCount);return n.disablePast&&l<=r.today()||n.disableFuture&&s>r.today()?null:s},He=(a,s)=>{d.currentHoveredItemId=a.id,n.doEmitItemMouseEvents&&o("item-mouseenter",a,s)},xe=(a,s)=>{d.currentHoveredItemId="",n.doEmitItemMouseEvents&&o("item-mouseleave",a,s)},Ue=(a,s)=>{var g,i;if(!n.enableDateSelection)return!1;(g=s.dataTransfer)==null||g.setData("text",a.toString());let l=new Image;return l.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",(i=s.dataTransfer)==null||i.setDragImage(l,10,10),d.dateSelectionOrigin=a,H("date-selection-start",a,s),!0},ze=(a,s)=>{var l;return n.enableDragDrop?((l=s.dataTransfer)==null||l.setData("text",a.id),d.currentDragItem=a,d.dateSelectionOrigin=null,o("drag-start",a,s),!0):!1},w=(a,s,l)=>n.enableDragDrop?(o(a,d.currentDragItem,s,l),!0):!1,Re=(a,s)=>{w("drag-over-date",a,s)},je=(a,s)=>{if(n.enableDateSelection&&d.dateSelectionOrigin){H("date-selection",a,s);return}if(!w("drag-enter-date",a,s))return;s.target.classList.add("draghover")},ve=(a,s)=>{if(n.enableDateSelection&&n.selectionStart||!w("drag-leave-date",a,s))return;s.target.classList.remove("draghover")},qe=(a,s)=>{if(n.enableDateSelection&&d.dateSelectionOrigin){H("date-selection-finish",a,s);return}if(!w("drop-on-date",a,s))return;s.target.classList.remove("draghover")},H=(a,s,l)=>{!d.dateSelectionOrigin||o(a,s<=d.dateSelectionOrigin?[s,d.dateSelectionOrigin,l]:[d.dateSelectionOrigin,s,l])},Ge=(a,s)=>a.startDate<s.startDate?-1:s.startDate<a.startDate?1:a.endDate>s.endDate?-1:s.endDate>a.endDate?1:a.id<s.id?-1:1,Qe=a=>j(a,r.addDays(a,6)),j=(a,s)=>$.value.filter(l=>l.endDate>=a&&r.dateOnly(l.startDate)<=s,this).sort(Ge),Je=a=>!!$.value.find(s=>s.endDate>=a&&r.dateOnly(s.startDate)<=a),v=a=>!(!n.selectionStart||!n.selectionEnd||a<r.dateOnly(n.selectionStart)||a>r.dateOnly(n.selectionEnd)),Ke=a=>{const s=Qe(a),l=[],g=[[],[],[],[],[],[],[]];for(let i=0;i<s.length;i++){const c=Object.assign({},s[i],{classes:[...s[i].classes],itemRow:0}),p=c.startDate<a,I=p?0:r.dayDiff(a,c.startDate),G=Math.min(7-I,r.dayDiff(r.addDays(a,I),c.endDate)+1);p&&c.classes.push("continued"),r.dayDiff(a,c.endDate)>6&&c.classes.push("toBeContinued"),r.isInPast(c.endDate)&&c.classes.push("past"),c.originalItem.url&&c.classes.push("hasUrl");for(let b=0;b<7;b++)if(b===I){let B=0;for(;g[b][B];)B++;c.itemRow=B,g[b][B]=!0}else b<I+G&&(g[b][c.itemRow]=!0);c.classes.push(`offset${I}`),c.classes.push(`span${G}`),l.push(c)}return l},Xe=a=>{const s='<span class="startTime">'+r.formattedTime(a.startDate,u.value,n.timeFormatOptions)+"</span>";let l="";return r.isSameDateTime(a.startDate,a.endDate)||(l='<span class="endTime">'+r.formattedTime(a.endDate,u.value,n.timeFormatOptions)+"</span>"),s+l},Ze=a=>n.showTimes?Xe(a)+" "+a.title:a.title,q=a=>{const s=a.itemRow,l=n.itemContentHeight,g=n.itemBorderHeight;return`calc(${n.itemTop} + ${s}*${l} + ${s}*${g})`};return(a,s)=>(t.openBlock(),t.createElementBlock("div",{"aria-label":"Calendar",class:t.normalizeClass(["cv-wrapper","locale-"+t.unref(r).languageCode(t.unref(u)),"locale-"+t.unref(u),"y"+t.unref(m).getFullYear(),"m"+t.unref(r).paddedMonth(t.unref(m)),"period-"+e.displayPeriodUom,"periodCount-"+e.displayPeriodCount,{past:t.unref(r).isPastMonth(t.unref(m)),future:t.unref(r).isFutureMonth(t.unref(m)),noIntl:!t.unref(r).supportsIntl}])},[t.renderSlot(a.$slots,"header",{headerProps:t.unref(Ne)}),t.createElementVNode("div",ge,[e.displayWeekNumbers?(t.openBlock(),t.createElementBlock("div",me)):t.createCommentVNode("",!0),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(Ee),(l,g)=>t.renderSlot(a.$slots,"dayHeader",{index:O(g),label:l},()=>[(t.openBlock(),t.createElementBlock("div",{key:O(g),class:t.normalizeClass([O(g),"cv-header-day"])},t.toDisplayString(l),3))])),256))]),t.createElementVNode("div",{"aria-multiselectable":e.enableDateSelection,class:"cv-weeks"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(Be),(l,g)=>(t.openBlock(),t.createElementBlock("div",{key:`${g}-week`,class:t.normalizeClass(["cv-week","week"+(g+1),"ws"+t.unref(r).isoYearMonthDay(l)])},[e.displayWeekNumbers?(t.openBlock(),t.createElementBlock("div",De,[t.renderSlot(a.$slots,"weekNumber",{date:l,numberInYear:t.unref(y)+g,numberInPeriod:g+1},()=>[t.createElementVNode("span",null,t.toDisplayString(t.unref(y)+g),1)])])):t.createCommentVNode("",!0),t.createElementVNode("div",he,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(r).daysOfWeek(l),(i,c)=>(t.openBlock(),t.createElementBlock("div",{key:O(c),draggable:e.enableDateSelection,class:t.normalizeClass(["cv-day",O(c),"d"+t.unref(r).isoYearMonthDay(i),"d"+t.unref(r).isoMonthDay(i),"d"+t.unref(r).paddedDay(i),"instance"+t.unref(r).instanceOfMonth(i),{today:t.unref(r).isSameDate(i,t.unref(r).today()),outsideOfMonth:!t.unref(r).isSameMonth(i,t.unref(D)),past:t.unref(r).isInPast(i),future:t.unref(r).isInFuture(i),last:t.unref(r).isLastDayOfMonth(i),lastInstance:t.unref(r).isLastInstanceOfMonth(i),hasItems:Je(i),selectionStart:t.unref(r).isSameDate(i,e.selectionStart),selectionEnd:t.unref(r).isSameDate(i,e.selectionEnd)},...e.dateClasses&&e.dateClasses[t.unref(r).isoYearMonthDay(i)]||[]]),"aria-grabbed":e.enableDateSelection?v(i):void 0,"aria-label":i.getDate().toString(),"aria-selected":v(i),"aria-dropeffect":e.enableDragDrop&&d.currentDragItem?"move":e.enableDateSelection&&d.dateSelectionOrigin?"execute":"none",onClick:p=>$e(i,p),onDragstart:p=>Ue(i,p),onDrop:t.withModifiers(p=>qe(i,p),["prevent"]),onDragover:t.withModifiers(p=>Re(i,p),["prevent"]),onDragenter:t.withModifiers(p=>je(i,p),["prevent"]),onDragleave:t.withModifiers(p=>ve(i,p),["prevent"])},[t.createElementVNode("div",be,t.toDisplayString(i.getDate()),1),t.renderSlot(a.$slots,"dayContent",{day:i})],42,ye))),128)),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Ke(l),i=>t.renderSlot(a.$slots,"item",{value:i,weekStartDate:l,top:q(i)},()=>[(t.openBlock(),t.createElementBlock("div",{key:i.id,draggable:e.enableDragDrop,"aria-grabbed":e.enableDragDrop?i==d.currentDragItem:void 0,class:t.normalizeClass([i.classes,"cv-item"]),title:i.tooltip||i.title,style:t.normalizeStyle(`top:${q(i)};${i.originalItem.style}`),onDragstart:c=>ze(i,c),onMouseenter:c=>He(i,c),onMouseleave:c=>xe(i,c),onClick:t.withModifiers(c=>Ve(i,c),["stop"]),innerHTML:Ze(i)},null,46,Pe))])),256))])],2))),128))],8,pe)],2))}}),nt="",Se={class:"cv-header"},Me={class:"cv-header-nav"},Ce=["disabled"],Oe=["disabled","innerHTML"],Ie=["disabled"],Le=["disabled"],Fe={class:"periodLabel"},we=t.defineComponent({__name:"CalendarViewHeader",props:{headerProps:{type:Object,required:!0},previousYearLabel:{type:String,default:"<<"},previousPeriodLabel:{type:String,default:"<"},nextPeriodLabel:{type:String,default:">"},nextYearLabel:{type:String,default:">>"}},emits:["input"],setup(e,{emit:o}){const n=d=>o("input",d);return(d,u)=>(t.openBlock(),t.createElementBlock("div",Se,[t.createElementVNode("div",Me,[t.createElementVNode("button",{disabled:!e.headerProps.previousYear,class:"previousYear","aria-label":"Previous Year",onClick:u[0]||(u[0]=t.withModifiers(D=>n(e.headerProps.previousYear),["prevent"]))},t.toDisplayString(e.previousYearLabel),9,Ce),t.createElementVNode("button",{disabled:!e.headerProps.previousPeriod,class:"previousPeriod","aria-label":"Previous Period",onClick:u[1]||(u[1]=t.withModifiers(D=>n(e.headerProps.previousPeriod),["prevent"])),innerHTML:e.previousPeriodLabel},null,8,Oe),t.createElementVNode("button",{class:"currentPeriod","aria-label":"Current Period",onClick:u[2]||(u[2]=t.withModifiers(D=>n(e.headerProps.currentPeriod),["prevent"]))},t.toDisplayString(e.headerProps.currentPeriodLabel),1),t.createElementVNode("button",{disabled:!e.headerProps.nextPeriod,class:"nextPeriod","aria-label":"Next Period",onClick:u[3]||(u[3]=t.withModifiers(D=>n(e.headerProps.nextPeriod),["prevent"]))},t.toDisplayString(e.nextPeriodLabel),9,Ie),t.createElementVNode("button",{disabled:!e.headerProps.nextYear,class:"nextYear","aria-label":"Next Year",onClick:u[4]||(u[4]=t.withModifiers(D=>n(e.headerProps.nextYear),["prevent"]))},t.toDisplayString(e.nextYearLabel),9,Le)]),t.createElementVNode("div",Fe,[t.renderSlot(d.$slots,"label",{},()=>[t.createTextVNode(t.toDisplayString(e.headerProps.periodLabel),1)])])]))}}),rt="";h.CalendarMath=r,h.CalendarView=ke,h.CalendarViewHeader=we,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
