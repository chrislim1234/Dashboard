{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, withDirectives as _withDirectives, vModelCheckbox as _vModelCheckbox, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  id: \"app\"\n};\nconst _hoisted_2 = {\n  class: \"wrapper\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h1\", {\n  class: \"text-center text-muted font-weight-bold\"\n}, \"Surveys Builder\", -1\n/* HOISTED */\n);\n\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_5 = {\n  class: \"input-form\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Title: \", -1\n/* HOISTED */\n);\n\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Subtitle: \", -1\n/* HOISTED */\n);\n\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"my-4\"\n}, \"Show on main screen: \", -1\n/* HOISTED */\n);\n\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Order: \", -1\n/* HOISTED */\n);\n\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_14 = /*#__PURE__*/_createElementVNode(\"label\", null, \"Section: \", -1\n/* HOISTED */\n);\n\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"br\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_17 = {\n  class: \"form-group my-4\"\n};\nconst _hoisted_18 = {\n  class: \"form-group\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Question = _resolveComponent(\"Question\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _hoisted_4, _createElementVNode(\"div\", _hoisted_5, [_createCommentVNode(\" <div :class=\\\"cl\\\" v-if=\\\"errMsg\\\">\\n          {{msg}}\\n        </div>\"), _hoisted_6, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.title = $event),\n    type: \"text\",\n    placeholder: \"Enter the title\",\n    class: _normalizeClass($options.classError('title'))\n  }, null, 2\n  /* CLASS */\n  ), [[_vModelText, _ctx.title]]), _hoisted_7, _hoisted_8, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.subtitle = $event),\n    type: \"text\",\n    placeholder: \"Enter the subtitle\",\n    class: _normalizeClass($options.classError('subtitle'))\n  }, null, 2\n  /* CLASS */\n  ), [[_vModelText, _ctx.subtitle]]), _hoisted_9, _hoisted_10, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.main = $event),\n    type: \"checkbox\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelCheckbox, _ctx.main]]), _hoisted_11, _hoisted_12, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _ctx.orderSurvey = $event),\n    type: \"number\",\n    min: \"1\",\n    pattern: \"^[0-9]+\",\n    class: _normalizeClass($options.classError('order'))\n  }, null, 2\n  /* CLASS */\n  ), [[_vModelText, _ctx.orderSurvey]]), _hoisted_13, _hoisted_14, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _ctx.section = $event),\n    type: \"text\",\n    placeholder: \"Enter the section\",\n    class: _normalizeClass($options.classError('section'))\n  }, null, 2\n  /* CLASS */\n  ), [[_vModelText, _ctx.section]]), _createCommentVNode(\" <br />\\n        <label>Icon: </label>\\n        <input type=\\\"file\\\" placeholder=\\\"Icon\\\" accept=\\\"image/*\\\" /> \"), _hoisted_15, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.questions, question => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: question.id\n    }, [_createVNode(_component_Question, {\n      question: question,\n      readonly: false,\n      onDeleteQuestion: $options.deleteQuestions,\n      ref_for: true,\n      ref: question.id\n    }, null, 8\n    /* PROPS */\n    , [\"question\", \"onDeleteQuestion\"])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  )), _hoisted_16, _createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"button\", {\n    onClick: _cache[5] || (_cache[5] = (...args) => $options.addQuestion && $options.addQuestion(...args)),\n    type: \"button\",\n    class: \"btn btn-secondary\"\n  }, \" Add question \")]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"button\", {\n    onClick: _cache[6] || (_cache[6] = (...args) => $options.saveSurveybuild && $options.saveSurveybuild(...args)),\n    type: \"button\",\n    class: \"btn btn-primary\"\n  }, \" Save \")])])])]);\n}","map":{"version":3,"sources":["/Users/chrislim/Desktop/USC/Senior Fall/CSCI401/CardinalKit-Web-Dashboard/cardinal-kit-web/src/views/surveys/surveysBuilder.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"wrapper\">\n      <h1 class=\"text-center text-muted font-weight-bold\">Surveys Builder</h1>\n      <br />\n      <div class=\"input-form\">\n        <!-- <div :class=\"cl\" v-if=\"errMsg\">\n          {{msg}}\n        </div>-->\n        <label>Title: </label>\n        <input v-model=\"title\" type=\"text\" placeholder=\"Enter the title\"  :class=\"classError('title')\"/>\n        <br />\n        <label>Subtitle: </label>\n        <input v-model=\"subtitle\" type=\"text\" placeholder=\"Enter the subtitle\" :class=\"classError('subtitle')\" />\n        <br />\n        <label class=\"my-4\">Show on main screen: </label>\n        <input v-model=\"main\" type=\"checkbox\" />\n        <br />\n        <label>Order: </label>\n        <input v-model=\"orderSurvey\" type=\"number\"  min=\"1\" pattern=\"^[0-9]+\" :class=\"classError('order')\"/>\n        <br />\n        <label>Section: </label>\n        <input v-model=\"section\" type=\"text\" placeholder=\"Enter the section\" :class=\"classError('section')\"/>\n        <!-- <br />\n        <label>Icon: </label>\n        <input type=\"file\" placeholder=\"Icon\" accept=\"image/*\" /> -->\n        <br>\n        <div v-for=\"question in questions\" :key=\"question.id\">\n          <Question :question=\"question\" :readonly=\"false\" @DeleteQuestion=\"deleteQuestions\" :ref=\"question.id\" />\n        </div>\n        <br />\n        <div class=\"form-group my-4\">\n          <button @click=\"addQuestion\" type=\"button\" class=\"btn btn-secondary\">\n            Add question\n          </button>\n        </div>\n\n        <div class=\"form-group\">\n          <button @click=\"saveSurveybuild\" type=\"button\" class=\"btn btn-primary\">\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Question from \"@/components/surveys/SurveyBuilder/Questions\";\nimport { mapActions, mapGetters } from \"vuex\";\nimport { uuidv4 } from \"@/helpers\";\nimport store from \"@/store\";\nimport Swal from 'sweetalert2'\n\nexport default {\n  name: \"App\",\n  props: {\n    studyId: {\n      type: String,\n      required: true,\n    }\n  },\n  data: () => ({\n      image: null,\n      main: true,\n      section: \"\",\n      subtitle: \"\",\n      title: \"\",\n      scopeTypes: [\"Public\", \"Private\"],\n      surveyName: \"\",\n      orderQuestion:0,\n      orderSurvey:\"1\",\n      questions: {},\n      errMsg: false,\n      msg:\"\",\n      cl: \"\",\n      errors:{}\n  }),\n  components: {\n      Question,\n  },\n  methods: {\n    ...mapActions(\"surveys\", [\"AddSurvey\"]),\n    addQuestion() {\n      this.errMsg = false\n      this.msg = \"\"\n      this.orderQuestion+=1\n      let id = uuidv4()\n      this.questions[id]={\n        title: \"\",\n        id: id,\n        type: \"\",\n        scope: \"public\",\n        identifier: \"\",\n        description: \"\",\n        question: [],\n        required: true,\n        options: [],\n        order:\"\"+this.orderQuestion\n      }\n    },\n    deleteQuestions(index) {\n      delete this.questions[index]\n    },\n    validSurvey(questions, data,isValid){\n      // review if question has data\n      for(const[key,value] of Object.entries(questions)){\n        if(!this.$refs[value.id].reviewQuestionData()){\n          isValid = false\n        }        \n      }\n      if(isValid){\n        let id = uuidv4()\n        data['identifier'] = id\n        this.AddSurvey({\n          id: id,\n          studyId: this.studyId,\n          questions: questions,\n          data: data,\n        }).then(()=>{\n          this.errMsg = true\n\n          Swal.fire({\n            title: 'success',\n            text:   \"Surveys Builder has been created successfully\",\n            icon: 'success'\n          }).then(()=>{\n            this.$router.push(`/surveysList/${this.studyId}`)\n          })\n        })\n      }\n      else{\n        this.errMsg = true\n        this.cl = \"alert-err\"\n        this.msg=\"Some data is incorrect\"\n\n        Swal.fire({\n          title: 'Error',\n          text: \"Some data is incorrect\",\n          icon: 'warning'\n        })\n      }\n    },\n    classError(value){\n      if(this.errors[value]){\n        return \"input-no-value-style\"\n      }\n      return \"\"\n    },\n    saveSurveybuild() {\n      this.errMsg = false\n      this.msg=\"\"\n      if(!(this.section && this.subtitle && this.title)){\n        Swal.fire({\n          title: 'Error',\n          text: \"The fields can't be blank\",\n          icon: 'warning'\n        })\n        this.errMsg = true  \n      }\n\n      if(Object.keys(this.questions).length){\n        let surveyData={\n          'image':\"SurveyIcon\",\n          'order':this.orderSurvey,\n          'section':this.section,\n          'subtitle':this.subtitle,\n          'title':this.title,\n          'main': this.main\n        }        \n          let questionIdentifiers = Object.keys(this.questions).map((key)=>{\n            return this.questions[key].identifier\n          }) \n          let uniqueIdentifiers =new Set(questionIdentifiers)\n          if(questionIdentifiers.length==uniqueIdentifiers.size){\n            this.validSurvey(this.questions, surveyData,!this.errMsg)\n          }\n          else{\n            if(!this.errMsg){\n              this.errMsg = true            \n              Swal.fire({\n                title: 'Error',\n                text: \"The question identifiers must be unique\",\n                icon: 'warning'\n              })\n            }\n           \n          }\n        }else{\n          if(!this.errMsg){\n            this.errMsg = true\n            Swal.fire({\n              title: 'Error',\n              text: \"The questions cannot be empty\",\n              icon: 'warning'\n            })\n          }\n        }\n\n\n\n      this.errors[\"title\"]=this.title ? false : true\n        this.errors[\"subtitle\"]=this.subtitle ? false : true\n        this.errors[\"section\"]=this.section ? false : true\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.input-no-value-style {\n  background-color:pink !important;\n}\n.wrapper {\n  margin-top: 5%;\n  margin-bottom: 5%;\n}\n.input-form{\n  margin: auto;\n  width: 60%;\n}\n.surveys > div {\n  margin: 10px 0;\n  padding-bottom: 10px;\n}\n.btn {\n  color: black;\n  background: transparent;\n  display: inline-block;\n  font-weight: 400;\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: middle;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  border: 1px solid transparent;\n  padding: 0.375rem 0.75rem;\n  font-size: 1rem;\n  line-height: 1.5;\n  border-radius: 0.25rem;\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out,\n    border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n}\n.btn-secondary {\n  text-decoration: none;\n  color: black;\n  border-color: #000000;\n  background: #b71540;\n}\n.btn-terceary {\n  text-decoration: underline;\n  color: black;\n  border-color: #000000;\n  background: transparent;\n}\n\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}